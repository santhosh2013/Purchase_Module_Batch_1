<div class="container mt-4">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col-12">
      <h2>
        <i class="bi bi-file-earmark-text text-info"></i>
        {{ isViewMode ? 'View Purchase Request' : (isEditMode ? 'Edit Purchase Request' : 'New Purchase Request') }}
      </h2>
      <p class="text-muted">{{ isViewMode ? 'View' : (isEditMode ? 'Update' : 'Create') }} purchase request details</p>
    </div>
  </div>

  <!-- Form -->
  <div class="card shadow-sm">
    <div class="card-body">
      <!-- FORM BINDS TO MODEL -->
      <form #purchaseRequestForm="ngForm" (ngSubmit)="onSubmit()">
        <div class="row">
          
          <!-- PR Number -->
          <div class="col-md-6 mb-3">
            <label for="prNumber" class="form-label">
              <i class="bi bi-hash me-1"></i>PR Number *
            </label>
            <input type="text" class="form-control" id="prNumber" name="prNumber" 
              [(ngModel)]="purchaseRequest.prNumber"
              required [readonly]="isViewMode" placeholder="Enter PR Number">
          </div>

          <!-- RENAMED: Event ID → G cross number -->
          <div class="col-md-6 mb-3">
            <label for="eventid" class="form-label">
              <i class="bi bi-calendar-event me-1"></i>G cross number *
            </label>
            <input type="number" class="form-control" id="eventid" name="eventid" 
              [(ngModel)]="purchaseRequest.eventid"
              min="0" required [readonly]="isViewMode" placeholder="Enter G cross number">
          </div>

          <!-- RENAMED: Event Name → Name of training -->
          <div class="col-md-6 mb-3">
            <label for="eventname" class="form-label">
              Name of training <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="text" class="form-control" id="eventname" name="eventname"
              [(ngModel)]="purchaseRequest.eventname" [required]="!isViewMode" minlength="2" maxlength="100"
              placeholder="Enter name of training" [readonly]="isViewMode">
          </div>

          <!-- Vendor ID -->
          <div class="col-md-6 mb-3">
            <label for="vendorid" class="form-label">
              <i class="bi bi-person-badge me-1"></i>Vendor ID *
            </label>
            <input type="number" class="form-control" id="vendorid" name="vendorid"
              [(ngModel)]="purchaseRequest.vendorid" min="0" required [readonly]="isViewMode"
              placeholder="Enter Vendor ID">
          </div>

          <!-- Vendor Name -->
          <div class="col-md-6 mb-3">
            <label for="vendorname" class="form-label">
              <i class="bi bi-building me-1"></i>Vendor Name *
            </label>
            <input type="text" class="form-control" id="vendorname" name="vendorname"
              [(ngModel)]="purchaseRequest.vendorname" required [readonly]="isViewMode" placeholder="Enter Vendor Name">
            <div class="invalid-feedback">
              Vendor Name is required
            </div>
          </div>

          <!--  RENAMED: CDSID → Requested by -->
          <div class="col-md-6 mb-3">
            <label for="cdsid" class="form-label">
              Requested by <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="text" class="form-control" id="cdsid" name="cdsid" 
              [(ngModel)]="purchaseRequest.cdsid"
              [required]="!isViewMode" minlength="2" maxlength="50" placeholder="Enter requested by (e.g., AB12, USER001)"
              [readonly]="isViewMode">
          </div>

          <!-- Request Date -->
          <div class="col-md-6 mb-3">
            <label for="requestdate" class="form-label">
              Request Date <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="date" class="form-control" id="requestdate" name="requestdate"
              [(ngModel)]="purchaseRequest.requestdate" [required]="!isViewMode" [max]="todayDate" [readonly]="isViewMode" >
          </div>

          <!--  RENAMED: Allocated Amount → Quotation amount -->
          <div class="col-md-6 mb-3">
            <label for="allocatedamount" class="form-label">
              Quotation amount (₹) <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="number" class="form-control" id="allocatedamount" name="allocatedamount"
              [(ngModel)]="purchaseRequest.allocatedamount" [required]="!isViewMode" min="0" step="0.01"
              [readonly]="isViewMode">
          </div>

          <!-- Status -->
          <div class="col-md-6 mb-3">
            <label for="prstatus" class="form-label">
              Status <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <select class="form-select" id="prstatus" name="prstatus" [(ngModel)]="purchaseRequest.prstatus"
              [required]="!isViewMode" [disabled]="isViewMode">
              <option *ngFor="let status of statusOptions" [value]="status">
                {{ status }}
              </option>
            </select>
          </div>
        </div>

        <!-- Buttons -->
        <div class="row mt-3">
          <div class="col-12">
            <!-- Submit Button (Hidden in View Mode) -->
            <button *ngIf="!isViewMode" type="submit" class="btn btn-info btn-lg me-2"
              [disabled]="!purchaseRequestForm.valid">
              <i class="bi bi-check-circle me-2"></i>
              {{ isEditMode ? 'Update' : 'Create' }}
            </button>

            <!-- Back Button -->
            <button type="button" class="btn btn-secondary btn-lg" (click)="goBack()">
              <i class="bi bi-x-circle me-2"></i>
              {{ isViewMode ? 'Close' : 'Cancel' }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
