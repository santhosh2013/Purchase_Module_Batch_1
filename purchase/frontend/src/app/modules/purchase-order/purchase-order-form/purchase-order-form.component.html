<div class="container mt-4">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col-12">
      <h2>
        <i class="bi bi-receipt text-success"></i>
        {{ isViewMode ? 'View Purchase Order' : (isEditMode ? 'Edit Purchase Order' : 'New Purchase Order') }}
      </h2>
      <p class="text-muted">{{ isViewMode ? 'View' : (isEditMode ? 'Update' : 'Create') }} purchase order details</p>
    </div>
  </div>

  <!-- Form -->
  <div class="card shadow-sm">
    <div class="card-body">
      <form #purchaseOrderForm="ngForm" (ngSubmit)="onSubmit()">
        <div class="row">
          <!-- Event ID - HIDDEN -->
          <div class="col-md-6 mb-3" style="display: none;">
            <label for="eventid" class="form-label">Event ID</label>
            <input type="number" class="form-control" id="eventid" name="eventid" [(ngModel)]="purchaseOrder.eventid"
              [readonly]="true">  
          </div>

          <!-- Event Name -->
          <div class="col-md-6 mb-3">
            <label for="eventname" class="form-label">
              Name of training <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="text" class="form-control" id="eventname" name="eventname"
              [(ngModel)]="purchaseOrder.eventname" [required]="!isViewMode" minlength="2" maxlength="100"
              placeholder="Enter event name" [readonly]="isEditMode || isViewMode">
          </div>

          <!-- Vendor ID - HIDDEN -->
          <div class="col-md-6 mb-3" style="display: none;">
            <label for="vendorid" class="form-label">Vendor ID</label>
            <input type="number" class="form-control" id="vendorid" name="vendorid" [(ngModel)]="purchaseOrder.vendorid"
              [readonly]="true">
          </div>

          <!-- Vendor Name -->
          <div class="col-md-6 mb-3">
            <label for="vendorname" class="form-label">
              <i class="bi bi-building me-1"></i>Vendor Name
            </label>
            <input type="text" class="form-control" id="vendorname" name="vendorname"
              [(ngModel)]="purchaseOrder.vendorname" [readonly]="true">
          </div>

          <!-- CDSID -->
          <div class="col-md-6 mb-3">
            <label for="cdsid" class="form-label">
              Requested by <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="text" class="form-control" id="cdsid" name="cdsid" [(ngModel)]="purchaseOrder.cdsid"
              [required]="!isViewMode" minlength="2" maxlength="50" placeholder="Enter CDSID (e.g., AB12, USER001)"
              [readonly]="isEditMode || isViewMode">
          </div>

          <!-- Order Date -->
          <div class="col-md-6 mb-3">
            <label for="orderdate" class="form-label">
              Order Date <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="date" class="form-control" id="orderdate" name="orderdate"
              [(ngModel)]="purchaseOrder.orderdate" [required]="!isViewMode" [max]="todayDate" [readonly]="isViewMode" >
          </div>

          <!-- Order Amount INR -->
          <div class="col-md-6 mb-3">
            <label for="orderamountINR" class="form-label">
              Order Amount (₹) <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="number" class="form-control" id="orderamountINR" name="orderamountINR"
              [(ngModel)]="purchaseOrder.orderamountINR" (ngModelChange)="onINRChange()" [required]="!isViewMode"
              min="0" step="0.01" [readonly]="isEditMode || isViewMode">
          </div>

          <!-- Order Amount Dollar -->
          <div class="col-md-6 mb-3">
            <label for="orderamountdollar" class="form-label">
              Order Amount ($) <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <input type="number" class="form-control" id="orderamountdollar" name="orderamountdollar"
              [(ngModel)]="purchaseOrder.orderamountdollar" (ngModelChange)="onUSDChange()" [required]="!isViewMode"
              min="0" step="0.01" [readonly]="isEditMode || isViewMode">
            <small class="text-muted">Exchange Rate: ₹{{ exchangeRate }} = $1</small>
          </div>

          <!-- UPDATED: Purchase Request Number -->
          <div class="col-md-6 mb-3">
            <label for="prNumber" class="form-label">
              Purchase Request Number
            </label>
            <input type="number" class="form-control" id="prNumber" name="prNumber" [(ngModel)]="purchaseOrder.prNumber"
              min="0" [readonly]="isEditMode || isViewMode">
          </div>

          <!-- Status -->
          <div class="col-md-6 mb-3">
            <label for="po_status" class="form-label">
              Status <span class="text-danger" *ngIf="!isViewMode">*</span>
            </label>
            <select class="form-select" id="po_status" name="po_status" [(ngModel)]="purchaseOrder.po_status"
              [required]="!isViewMode" [disabled]="isViewMode">
              <option *ngFor="let status of statusOptions" [value]="status">
                {{ status }}
              </option>
            </select>
          </div>

        </div>

        <!-- Buttons -->
        <div class="row mt-3">
          <div class="col-12">
            <!-- Submit Button (Hidden in View Mode) -->
            <button *ngIf="!isViewMode" type="submit" class="btn btn-success btn-lg me-2"
              [disabled]="!purchaseOrderForm.valid">
              <i class="bi bi-check-circle me-2"></i>
              {{ isEditMode ? 'Update' : 'Create' }}
            </button>

            <!-- Back Button -->
            <button type="button" class="btn btn-secondary btn-lg" (click)="goBack()">
              <i class="bi bi-x-circle me-2"></i>
              {{ isViewMode ? 'Close' : 'Cancel' }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>